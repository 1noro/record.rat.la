<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>record.rat.la</title>
        <description>Blog/web personal donde iré registrando mis proyectos y mis líos mentales.</description>
        <language>es-es</language>
        <link>https://record.rat.la/</link>
        <atom:link href="https://record.rat.la/rss.xml" rel="self" type="application/rss+xml"/>
        <image>
            <title>record.rat.la</title>
            <url>https://record.rat.la/favicon.png</url>
            <link>https://record.rat.la/</link>
        </image>

<item>
    <title>Software que utilizo habitualmente</title>
    <guid>https://record.rat.la/index.php?page=mi-software.html</guid>
    <link>https://record.rat.la/index.php?page=mi-software.html</link>
    <!--<author>Inoro</author>-->
    <pubDate>Wed, 10 Mar 2021 13:32:00 +0100</pubDate>
    <description>
<![CDATA[<!-- 202103101332i -->
<h1>Software que utilizo habitualmente</h1>

<p>
    Solo listaré aquí programas que considero probados y que he usado durante 
    un tiempo.
</p>

<h2>Básico</h2>

<h3>Sistemas Operativos</h3>

<ul>
    <li>
        <a href="https://archlinux.org/download/"><b>Arch Linux</b></a> es mi 
        distribución principal actualmente en mi PC y portátil.
    </li>
    <li>
        <a href="https://www.debian.org/index.es.html"><b>Debian</b></a> lo 
        utilizo en mis servidores, en mi opinión es la mejor opción para un 
        servidor.
    </li>
    <li>
        <a href="https://ubuntu.com/download/server"><b>Ubuntu Server LTS</b></a> 
        lo utilizo también en mis servidores cuando considero que Debian se 
        queda un poco anticuado, o si voy a probar una aplicación que está mas 
        orientada a esta distribución. No suelo tener muchas instalaciones con 
        este SO, porque muchas veces solo tengo que esperar a la siguiente 
        versión de Debian.
    </li>
</ul>

<h3>Window Manager/Desktop Environment</h3>

<p>
    <b>gnome-shell</b> es el entorno de escritorio que mas me gusta y estoy 
    muy acostumbrado a su <em>workflow</em>. De todas formas estoy muy 
    interesado en probar un <em>tiling window manager</em> estilo 
    <b>dwm</b> o <b>i3</b> en el que sea capaz de recordar todos sus 
    comandos.
</p>

<h3>Terminal</h3>

<p>
    <b>gnome-terminal</b>, la uso porque es la que viene por defecto con 
    <b>gnome-shell</b> pero puede que cambie en algún momento. Busco algo 
    mas simple, como <b>st</b> (simple terminal) de 
    <a href="https://st.suckless.org/">suckless.org</a>, pero aún debería 
    probarla por algún tiempo mas para decidirme.
</p>

<h3>Shell</h3>

<p>
    <b>bash</b>, soy una persona a la que le gusta el default, por lo que 
    aún no veo necesario mudarme a <b>zsh</b>, a pesar de que promete mucha 
    mas flexibilidad.
</p>

<!-- <h3>Editores de texto y entornos de programación</h3>

<p>
    Esta sección no solo es confusa, sinó que en realidad yo me encuentro muy 
    confuso al respecto. Sigo buscando el editor de texto definitivo, he 
    probado muchos, pero no paro de cambiar. Me gustaría proba <b>vim</b> pero 
    creo que aún no estoy preparado.
</p>

<ul>
    <li>
        <b>Visual Studio Code</b> es actualmente mi entorno de desarrollo por 
        defecto. Es rápido y muy extensible gracias a todos los plugins que se 
        le pueden instalar. Empezé usando <b>atom</b> pero acabé canasdome de lo mal que funciona su cliente de <b>git</b>
    </li>
    <li>
        <b>geany</b> para editar texto plano sin necesidad de plugins. Aunque cada vez lo uso menos, y para una función tan simple como esta acabo usando <b>nano</b>.
    </li>
</ul> -->]]>
    </description>
</item>

<item>
    <title>Gitlab con NGINX reverse proxy</title>
    <guid>https://record.rat.la/index.php?page=gitlab-nginx.html</guid>
    <link>https://record.rat.la/index.php?page=gitlab-nginx.html</link>
    <!--<author>Inoro</author>-->
    <pubDate>Sun, 07 Mar 2021 11:07:00 +0100</pubDate>
    <description>
<![CDATA[<!-- 202103071107i -->
<h1>Gitlab con NGINX reverse proxy</h1>

<p>
    Voy a documentar el proceso de instalación de Gitlab en una máquina virtual 
    detrás de un NGINX reverse proxy.
</p>

<h2>Escenario</h2>

<p>
    <img src="https://record.rat.la/img/202103071107/gitlab-nginx.webp" alt="Diagrama.">
</p>

<h3>Características</h3>

<ul>
    <li>Certificado SSL con Let's Encrypt y certbot.</li>
    <li>
        Escuchar en los puertos 80 (HTTP) y 443 (HTTPs) con una redirección 
        automática desde el 80 al 443.
    </li>
    <li>
        Acceso mediante SSH con clave publica y protegido co fail2ban.
    </li>
</ul>

<h2>Configuración del router</h2>

<p>
    En la sección de redirección de puertos (port forwarding) de nuestro router 
    creamos dos registros nuevos sobre el protocolo TCP.
</p>

<ul>
    <li>El puerto 80 del router apuntará al puerto 80 de la máquina de NGINX (192.168.1.105), para las conexiones HTTP.</li>
    <li>El puerto 443 del router apuntará al puerto 443 de la máquina de NGINX (192.168.1.105), para las conexiones HTTPs.</li>
    <li>El puerto 22 del router apuntará al puerto 22 de la máquina de Gitlab (192.168.1.108), para las conexiones SSH.</li>
</ul>

<h2>Configuración de NGINX</h2>

<p>Nos situamos en la máquina que va a ejercer de reverse proxy con NGINX.</p>

<p>
    Creamos el archivo <samp>/etc/nginx/sites-available/git.example.com.conf</samp>
</p>

<pre>
server {
    listen 80;
    listen [::]:80;
    server_name git.example.com;

    location / {
        proxy_pass "http://192.168.1.108/";
        proxy_redirect off;
        proxy_set_header Host $http_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-Protocol $scheme;
        proxy_set_header X-Url-Scheme $scheme;
    }
}
</pre>

<p>Habilitamos el sitio.</p>

<pre>
ln -s /etc/nginx/sites-available/git.example.com.conf /etc/nginx/sites-enabled/
</pre>

<p>
    Testeamos la sintaxis de la configuración de NGINX, y si todo va bien, 
    recargamos la configuración.
</p>

<pre>
nginx -t
systemctl reload nginx
</pre>

<p>
    Con el Virtual Host correctamente configurado en NGINX, ejecutamos el certbot.
</p>

<pre>
certbot --nginx -d git.example.com
</pre>

<blockquote>
    Durante el proceso de creación del certificado indicamos que queremos 
    redireccionar el tráfico HTTP al HTTPs.
</blockquote>

<p>
    Archivo <samp>/etc/nginx/sites-available/git.example.com.conf</samp> 
    después de ejecutar el certbot.
</p>

<pre>
server {
    server_name git.example.com;

    location / {
        proxy_pass "http://192.168.1.108/";
        proxy_redirect off;
        proxy_set_header Host $http_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-Protocol $scheme;
        proxy_set_header X-Url-Scheme $scheme;
    }

    listen [::]:443 ssl; # managed by Certbot
    listen 443 ssl; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/git.example.com/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/git.example.com/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
}

server {
    if ($host = git.example.com) {
        return 301 https://$host$request_uri;
    } # managed by Certbot

    listen 80;
    listen [::]:80;

    server_name git.example.com;
    return 404; # managed by Certbot
}
</pre>

<h2>Configuración SSH</h2>

<p><a href="https://docs.github.com/es/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">Generamos en nuestro equipo una clave SSH.</a></p>

<p>Copiamos la clave a la máquina del Gitlab (192.168.1.108).</p>

<pre>
ssh-copy-id -i ~/.ssh/id_rsa.pub user@192.168.1.108
</pre>

<p>Nos situamos en la máquina que va a ejecutar Gitlab (192.168.1.108).</p>

<p>
    Editamos el archivo <samp>/etc/ssh/sshd_config</samp> y nos aseguramos de 
    que las siguientes lineas tengan los valores mostrados.
</p>

<pre>
UsePAM yes
PasswordAuthentication no
</pre>

<p>Y agregamos la siguiente linea al final.</p>

<pre>
PermitRootLogin no
</pre>

<p>Guardamos y reiniciamos el servicio.</p>

<pre>
sudo systemctl restart sshd
</pre>

<h3>Fail2ban</h3>

<p>Instalamos el programa.</p>

<pre>
sudo apt update
sudo apt install fail2ban
</pre>

<p>Creamos el archivo <samp>/etc/fail2ban/jail.local</samp> y agregamos las siguientes lineas.</p>

<pre>
[DEFAULT]
ignoreip = 127.0.0.1/8 192.168.1.0/24
bantime = 10m
maxretry = 5
findtime = 1d

[sshd]
enabled = true
</pre>

<p>Guardamos y reiniciamos el servicio.</p>

<pre>
sudo systemctl restart fail2ban
</pre>

<h2>Instalación y configuración de Gitlab</h2>

<p>Nos situamos en la máquina que va a ejecutar Gitlab (192.168.1.108).</p>

<p>Instalamos los paquetes necesarios y agregamos el repositorio de Gitlab.</p>

<pre>
sudo apt update
sudo apt install curl openssh-server ca-certificates tzdata perl postfix
</pre>

<pre>
curl -sS https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash
</pre>

<pre>
sudo EXTERNAL_URL="http://git.example.com" apt-get install gitlab-ce
</pre>

<blockquote>
    Nótese que el parámetro <samp>EXTERNAL_URL</samp> se define con <samp>http</samp> y no con <samp>https</samp>.
</blockquote>

<p>
    Editamos el archivo <samp>/etc/gitlab/gitlab.rb</samp> y agregamos las siguientes lineas al final.
</p>

<pre>
nginx['listen_port'] = 80
nginx['listen_https'] = false

nginx['proxy_set_headers'] = {
    "X-Forwarded-Proto" => "http"
}

nginx['real_ip_trusted_addresses'] = [ '192.168.1.0/24' ]
nginx['real_ip_header'] = 'X-Forwarded-For'
nginx['real_ip_recursive'] = 'on'
</pre>

<p>
    Reconfiguramos Gitlab.
</p>

<pre>
sudo gitlab-ctl reconfigure
</pre>

<blockquote>
    Hay que espera un rato a que se reconfigure, incluso después de que el 
    comando haya finalizado.
</blockquote>

<p>
    Una vez acabado este proceso ya podremos acceder a nuestro Gitlab a través 
    de HTTPs para definir la contraseña del usuario <samp>root</samp>.
</p>

<h2>Bibliografía</h2>

<ul>
    <li><a href="https://linuxize.com/post/install-configure-fail2ban-on-ubuntu-20-04/">How to Install and Configure Fail2ban on Ubuntu 20.04</a></li>
    <li><a href="https://about.gitlab.com/install/#ubuntu">Gitlab Official Linux package (recommended installation)</a></li>
    <li><a href="https://docs.gitlab.com/omnibus/settings/nginx.html">Gitlab NGINX settings</a></li>
</ul>]]>
    </description>
</item>

<item>
    <title>Solución a algunas series numéricas en Java y Python</title>
    <guid>https://record.rat.la/index.php?page=solucion-series-numericas-java-python.html</guid>
    <link>https://record.rat.la/index.php?page=solucion-series-numericas-java-python.html</link>
    <!--<author>Inoro</author>-->
    <pubDate>Sun, 04 Oct 2020 11:36:00 +0200</pubDate>
    <description>
<![CDATA[<!-- 202010041136i -->
<h1>Solución a algunas series numéricas en Java y Python</h1>

<p>
    Lista del código que calcula las diferentes series numéricas propuestas en el Ejercicio evaluable 1 de la asignatura Programación Multimedia y Dispositivos Móviles.
</p>

<blockquote>
    <i>Voy a tomar como regla que todas las listas serán de 100 elementos como máximo.</i>
</blockquote>

<h2>1. La serie de Fibonacci</h2>

<p>Mi explicación: Empezando con <samp>[0, 1]</samp>, el siguiente se calcula con la suma de los dos anteriores.</p>

<h3>Fibonacci en Java</h3>

<pre>
package ej1pmydm;

public class Ej1pmydm {
    public static void main(String[] args) {
        double lista[] = new double[100];
        lista[0] = 0;
        lista[1] = 1;
        int i = 1;
        while (i < lista.length - 1) {
            lista[i + 1] = lista[i - 1] + lista[i];
            i++;
        }
        for (i = 0; i < lista.length; i++) {
            System.out.println(lista[i]);
        }
    }
}
</pre>

<h3>Fibonacci en Python</h3>

<pre>
lista = [0, 1]
while len(lista) < 100:
    lista.append(lista[-2] + lista[-1])
print(lista)
</pre>

<h2>2. La serie de Tribonacci</h2>

<p>Mi explicación: Empezando con <samp>[1, 1, 2]</samp>, el siguiente se calcula con la suma de los tres anteriores.</p>

<h3>Tribonacci en Java</h3>

<pre>
package ej2pmydm;

public class Ej2pmydm {
    public static void main(String[] args) {
        double lista[] = new double[100];
        lista[0] = 1;
        lista[1] = 1;
        lista[2] = 2;
        int i = 2;
        while (i < lista.length - 1) {
            lista[i + 1] = lista[i - 2] + lista[i - 1] + lista[i];
            i++;
        }
        for (i = 0; i < lista.length; i++) {
            System.out.println(lista[i]);
        }
    }
}
</pre>

<h3>Tribonacci en Python</h3>

<pre>
lista = [1, 1, 2]
while len(lista) < 100:
    lista.append(lista[-3] + lista[-2] + lista[-1])
print(lista)
</pre>

<h2>3. La serie en la cual si el anterior es par se suman los tres anteriores y, si es impar, solo los dos anteriores</h2>

<p>
    Mi explicación: Empezamos con la lista <samp>[1, 1]</samp>.
    <ul>
        <li>Si el último es impar, se suman los 2 últimos para calcular el siguiente.</li>
        <li>Si el último es par, se suman los 3 últimos para calcular el siguiente.</li>
    </ul>
</p>

<h3>La serie anterior en Java</h3>

<pre>
package ej3pmydm;

public class Ej3pmydm {
    public static void main(String[] args) {
        double lista[] = new double[100];
        lista[0] = 1;
        lista[1] = 1;
        int i = 1;
        while (i < lista.length - 1) {
            if (lista[i] % 2 != 0) {
                lista[i + 1] = lista[i - 1] + lista[i];
            } else {
                lista[i + 1] = lista[i - 2] + lista[i - 1] + lista[i];
            }
            i++;
        }
        for (i = 0; i < lista.length; i++) {
            System.out.println(lista[i]);
        }
    }
}
</pre>

<h3>La serie anterior en Python</h3>

<pre>
lista = [1, 1]
while len(lista) < 100:
    if lista[-1] % 2 != 0:
        lista.append(lista[-1] + lista[-2])
    else:
        lista.append(lista[-1] + lista[-2] + lista[-3])
print(lista)
</pre>

<h2>4. La serie de los cuadrados perfectos escritos al revés</h2>

<p>Tengo dudas, no se si se refiere a esto:</p>

<h3>Los cuadrados perfectos al revés en Java</h3>

<pre>
package ej4pmydm;

public class Ej4pmydm {
    public static void main(String[] args) {
        int lista[] = new int[100];
        int numero = 100;
        int i = 0;
        while (i < lista.length) {
            lista[i] = numero * numero;
            numero--;
            i++;
        }
        for (i = 0; i < lista.length; i++) {
            System.out.println(lista[i]);
        }
    }
}
</pre>

<h3>Los cuadrados perfectos al revés en Python</h3>

<pre>
lista = []
numero = 100
while numero > 0:
    lista.append(numero * numero)
    numero -= 1
print(lista)
</pre>

<h2>5. La serie que suma las cifras de los anteriores</h2>

<p>Ojo, se refiere a el <b>número de cifras</b>, no a la suma del os valores anteriores.</p>

<h3>La suma las cifras de los anteriores en Java</h3>

<pre>
package ej5pmydm;

public class Ej5pmydm {
    public static void main(String[] args) {
        int lista[] = new int[100];
        lista[0] = 1;
        int i = 0;
        while (i < lista.length - 1) {
            lista[i+1] = lista[i] + Integer.toString(lista[i]).length();
            i++;
        }
        for (i = 0; i < lista.length; i++) {
            System.out.println(lista[i]);
        }
    }
}
</pre>

<h3>La suma las cifras de los anteriores en Python</h3>

<pre>
lista = [1]
while len(lista) < 100:
    nuevo = 0
    for numero in lista:
        nuevo += len(str(numero))
    lista.append(nuevo)
print(lista)
</pre>
]]>
    </description>
</item>

<item>
    <title>La forma más rápida de hacer git push</title>
    <guid>https://record.rat.la/index.php?page=la-forma-mas-rapida-de-hacer-un-git-push.html</guid>
    <link>https://record.rat.la/index.php?page=la-forma-mas-rapida-de-hacer-un-git-push.html</link>
    <!--<author>Inoro</author>-->
    <pubDate>Wed, 30 Sep 2020 12:40:00 +0200</pubDate>
    <description>
<![CDATA[<!-- 202009301240i -->
<h1>La forma más rápida de hacer <samp>git push</samp></h1>

<p>
    Estos tres comandos, que se deben copiar y pegar en bloque, son la forma mas sencilla para subir tus cambios de un repositorio a la nube.
</p>

<h2>Requisitos previos a la ejecución</h2>

<ul>
    <li>Haber configurado el usuario y el correo electrónico.</li>
    <li>Situar la terminal en la carpeta raíz del repositorio (la primera).</li>
</ul>

<p>Para configurar el usuario y el correo electrónico se deben ejecutar los siguientes comandos:</p>

<pre>
git config --global user.name "nombre"
git config --global user.email "email@example.com"
</pre>

<p>Una vez se hayan cumplido los requisitos previos, solo hay que copiar <b>todos</b> los comandos que vienen a continuación y los pegamos en la terminal.</p>

<pre>
git add . \
git commit -m "repositorio actualizado" \
git push
</pre>

<blockquote>
    Si tenemos configurado el <i>GIT</i> por <i>SSH</i> no hace falta que pongáis la contraseña, pero si lo tenéis por <i>HTTPS</i>, os solicitará el nombre de usuario y la contraseña de <i>GitHub</i>, <i>GitLab</i>, etc.
</blockquote>
]]>
    </description>
</item>

<item>
    <title>Cowboy Bebop – The Real Folk Blues</title>
    <guid>https://record.rat.la/index.php?page=cowboy-bebop.html</guid>
    <link>https://record.rat.la/index.php?page=cowboy-bebop.html</link>
    <!--<author>Inoro</author>-->
    <pubDate>Mon, 28 Sep 2020 18:10:00 +0200</pubDate>
    <description>
<![CDATA[<!-- 202009281810i -->
<h1>Cowboy Bebop – <i>The Real Folk Blues</i></h1>

<blockquote>
    I think it's time to blow this scene.<br>
    Get everybody and their stuff together.<br>
    Okay, three, two, one ¡Let's jam!
</blockquote>

<p>
    Este artículo lo publiqué originalmente en un antiguo blog que hoy en día está desaparecido. Y ya que últimamente estoy haciendo reorganización y borrado de <i>backups</i> encuentro muchas antiguas joyas. Esta en concreto me gusta bastante, así que decidí re-publicarla. Espero que os anime a ver esta maravillosa serie, por la que sigo sintiendo el mismo aprecio que se ve reflejado aquí.
</p>

<p>
    <img src="https://record.rat.la/img/202009281810/cover.webp" alt="Portada del artículo.">
</p>

<p>
    La humanidad en el año 2071, una época decadente en la que todo acaba, donde los hombres se dedican a explorar los confines del vasto universo, con la tierra reducida a un desolado desierto convirtiendo a Marte en el planeta con mayor población del universo conocido. Gracias a estas "excelentes" condiciones el nivel de criminalidad ha aumentado de tal forma que todo se asemeja mucho al salvaje oeste, razón por la cual ser un cazarecompensas se ha convertido un oficio muy lucrativo.
</p>

<p>
    Este es el paisaje en el que se sitúa Cowboy Bebop, una pequeña y poco conocida obra de arte de 26 episodios con la que, aunque no seas un <a href="https://es.wikipedia.org/wiki/Otaku">otaku</a> de cuidado, podrás disfrutar como el que más con las aventuras que viven los protagonistas de la serie en su vida como cazarecompensas espaciales. Un <i>western</i> intergaláctico con fundamentos muy arraigados en el cine negro y algún guiño de géneros como el <i>cyberpunk</i> al estilo de Blade Runner,  una combinación perfecta de imagen y sonido que producen un sinfín de sensaciones mientras estas sentado tranquilamente frente a tu televisor.
</p>

<!-- <div class="img-2">
    <a target="_blank" href="https://record.rat.la/img/de_doc/cbEd.gif">
        <img src="https://record.rat.la/img/de_doc/cbEd.gif" alt="Edward balanceándose">
    </a>
    <div class="desc">
        Edward y su PC
    </div>
</div> -->

<p>
    La historia se centra en la tripulación de la nave bautizada como <i>Bebop</i>, formada por un grupo de personajes muy variopintos: <b>Spike</b>; pasota, sarcástico, divertido, fiel, temerario y con un cierto parecido a Lucky Luck. <b>Jet</b>; un amigo de toda confianza que siempre está allí para cuando se le necesita. <b>Faye</b>; una chica independiente que viene y va según su parecer y, aunque se empeñe en ocultarlo ella también tiene sentimientos. <b>Ed</b>; una niña espontánea, graciosa y muy inteligente, con grandes facetas como <i>hacker</i>. Y <b>Ein</b>; un <a href="https://es.wikipedia.org/wiki/Corgi_gal%C3%A9s_de_Pembroke" title="Raza de perro.">corgi</a> que destaca por su gran astucia. Una tropa de cazarecompensas que vagan por el espacio viviendo aventuras y subsistiendo como pueden. Ellos no son buenos, pero tampoco son malos, son personas corrientes como tu o como yo, amigos que te acompañan durante un viaje alucinante dejando un gran vacío cundo este termina. Todos ellos poseen un oscuro pasado que marca parte de su comportamiento, el cual no lograrás entender hasta prácticamente el final de la serie.
</p>

<p>
    Nos encontramos ante un <a href="https://es.wikipedia.org/wiki/Anime">anime</a> muy original, el propio hecho de no tener un <a href="https://es.wikipedia.org/wiki/Manga">manga</a> en el que basarse ya lo distingue de la mayoría de los animes convencionales. Además la manera de contar la historia en capítulos individuales y autoconclusivos, es una forma muy versátil de tratar diferentes temas aportando calidad a las diferentes sub-tramas que van surgiendo a lo largo de la serie sobre los pasados inciertos de los protagonistas, presentándonoslos como pequeñas piezas de un gran puzzle que solo lograremos entender al final. Gracias a este recurso de los capítulos separados <a href="https://es.wikipedia.org/wiki/Shin'ichir%C5%8D_Watanabe" title="Shin'ichirō Watanabe">el autor</a> expone una serie de historias muy diferentes que navegan entre géneros como el drama, la comedia, la acción o el terror.
</p>

<p>
    Y por último queda resaltar uno de los elementos más importante de la serie, con el cual este anime alcanza mi clasificación como obra de arte. La banda sonora, una preciosa <i>OST</i> centrada no solo en el <a href="https://es.wikipedia.org/wiki/Bebop"><i>bebop</i></a>, como el título indica, sino que recorre todo el jazz adentrándose incluso en otros géneros como el <i>rock</i> o el <i>rhythm&blues</i>, y hasta el <i>funkie</i>. La combinación de imagen y sonido en esta serie es perfecta, sobre todo en las excelentemente coreografiadas escenas de lucha y las batallas espaciales a ritmo del mejor jazz.
</p>

<!-- <iframe class="yt" width="560" height="315" src="https://www.youtube.com/embed/fS8Klrf1DSo" frameborder="0" allowfullscreen></iframe> -->

<p>
    Cowboy Bebop es una serie fabulosa, serie que toca un montón de temas usuales y no tan usuales con los que disfrutarás como un niño, proporcionando de vez en cuando momentos muy filosóficos que te hacen reflexionar ante la pantalla. Dejándonos al final de cada capítulo una frase que muchas veces resume a la perfección lo que se acaba de presenciar. Yo también despediré este artículo con una de esas frases.
</p>

<h3 style="text-align: right;"><i>SEE YOU SPACE COWBOY...</i></h2>

<!-- <iframe class="yt" width="420" height="315" src="https://www.youtube.com/embed/Aw3fN3OPk3A" frameborder="0" allowfullscreen></iframe> -->

<p>
    Publicado originalmente el 9 de Abril de 2016.
</p>
]]>
    </description>
</item>

<item>
    <title>Habilitar HTTP/2 en Nginx</title>
    <guid>https://record.rat.la/index.php?page=habilitar-http2-nginx.html</guid>
    <link>https://record.rat.la/index.php?page=habilitar-http2-nginx.html</link>
    <!--<author>Inoro</author>-->
    <pubDate>Sun, 27 Sep 2020 13:30:00 +0200</pubDate>
    <description>
<![CDATA[<!-- 202009271330i -->
<h1>Habilitar HTTP/2 en Nginx</h1>

<p>
Utilizando la configuración de Nginx ya explicada en <a href="index.php?page=configurando-nginx-para-esta-web.html">este artículo</a> para esta misma página. Vamos a habilitar el protocolo HTTP/2 para mejorar la eficiencia y la seguridad a la hora de ofrecer la web al usuario final.
</p>

<p>Primero, editamos la configuración de nuestro <i>Virtual Host</i>.</p>

<pre>
nano /etc/nginx/conf.d/record.rat.la.conf
</pre>

<p>
    Una vez dentro, localizamos las siguientes líneas.
</p>

<pre>
listen [::]:443 ssl ipv6only=on; # managed by Certbot
listen 443 ssl; # managed by Certbot
</pre>

<p>Y las modificamos de esta forma.</p>

<pre>
listen [::]:443 ssl http2 ipv6only=on; # managed by Certbot
listen 443 ssl http2; # managed by Certbot
</pre>

<p>Ahora buscamos esta otra línea y la comentamos con un <samp>#</samp>.</p>

<pre>
include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
</pre>

<p>Justo debajo de la linea comentada agregamos la siguiente.</p>

<pre>
ssl_ciphers EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;
</pre>

<p>Guardamos el archivo y comprobamos si la configuración es correcta con <code>nginx -t</code>. Si todo está correcto, continuamos.</p>

<p>Editamos o creamos el archivo <samp>/etc/nginx/snippets/ssl-params.conf</samp>, y localizamos la siguiente línea.</p>

<pre>
ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384;
</pre>

<pre>Y la modificamos como esta.</pre>

<pre>
ssl_ciphers EECDH+CHACHA20:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5;
</pre>

<blockquote>
    Puede darse el caso en el que el archivo <samp>/etc/nginx/snippets/ssl-params.conf</samp> esté vacío, o no exista. En ese caso solo tendremos que agregar la linea modificada.
</blockquote>

<p>Volvemos a comprobar la configuración con <code>nginx -t</code>. Si es correcta, refrescamos la configuración del Nginx.</p>

<pre>
systemctl reload nginx
</pre>

<p>Podemos comprobar los cambios con el siguiente comando.</p>

<pre>
curl -I -L https://record.rat.la
</pre>

<p>este es el resultado:</p>

<pre>
HTTP/2 200
server: nginx/1.14.2
date: Sun, 27 Sep 2020 11:46:58 GMT
content-type: text/html; charset=UTF-8
set-cookie: PHPSESSID=huc8hodo8l7qgii3jfbqacoas8; path=/
expires: Thu, 19 Nov 1981 08:52:00 GMT
cache-control: no-store, no-cache, must-revalidate
pragma: no-cache
</pre>

<p>Ahí se puede apreciar que ahora se está utilizando el protocolo HTTP/2.</p>

<h2>Referencias:</h2>

<ul>
    <li><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-with-http-2-support-on-ubuntu-18-04">How To Set Up Nginx with HTTP/2 Support on Ubuntu 18.04</a></li>
</ul>
]]>
    </description>
</item>

<item>
    <title>Reflexión sobre los "Buenos días" en los chats on-line</title>
    <guid>https://record.rat.la/index.php?page=los-buenos-dias-en-los-chats.html</guid>
    <link>https://record.rat.la/index.php?page=los-buenos-dias-en-los-chats.html</link>
    <!--<author>Inoro</author>-->
    <pubDate>Sat, 26 Sep 2020 12:32:00 +0200</pubDate>
    <description>
<![CDATA[<!-- 202009261232i -->
<h1>Reflexión sobre los "Buenos días" en los chats on-line</h1>

<p>
    Nos ponemos en situación; tu estas en un chat en el que puedes, o no, conocer a todos los integrantes, pongamos que te levantas a las 6:00 AM (típica hora rutinaria durante el curso escolar) y como no hay mensajes nuevos y, aludiendo al proverbio hindú, si no tienes nada que decir que merezca la pena romper el silencio, te quedarás calladito. Opino que a las 6:00 AM no tienes nada interesante que quieras o puedas decir.
</p>

<p>
    Aunque la vida es imprevisible, si mientras vas andando por la calle en la mañana, se te cruza un hombre con frack y bombín portando en su hombro derecho, con gran maestría, un arpón ballenero, no creo que debas quedarte callado. Eso merece, como mínimo, foto y difusión completa en los medios cibernéticos. Retomando el hilo principal: tras unas horas los demás integrantes del chat se van levantando y, rigiéndose (o no) por ese proverbio hindú, chatearán alguna cosa interesante (o no). La mañana continúa y el chat puede (o no) tener una fluidez abismal, pero en ambos casos lo que ocurrirá luego merece ser tratado. Este es el escenario: ya es por la tarde, hace un rato has degustado una comida mediocre y campas a tus anchas por tu dispositivo infernal de comunicación cuando... ¡Un mensaje salvaje aparece! dependiendo de lo aburrido que te encuentres: lo leerás inmediatamente esperando que sea "el mensaje del día", uno de esos mensajes de los que solo hay uno al día, un mensaje por el que gracias a el se origina la conversación más larga y más interesante. Ese tipo de mensajes son el motivo de tu permanencia en el chat. O, por otra parte, ignoras esa notificación, porque dependiendo de unas razones u otras, no estás de humor para chatear. Y entonces es cuando lo ves... ese mensaje que recibes a las 5 de la tarde, lo lees, no te lo crees. Lo vuelves a leer, para confirmar que lo has entendido bien y que la totalidad de su significado ha cuajado en tu cerebro. En ese momento es cuando te das cuenta de que uno de los integrantes del grupo ha malgastado esos bytes de ceros y unos, única y exclusivamente para escribir "Buenos días".
</p>

<p>
    Tu te paras, y piensas: cualquiera de los demás integrantes del chat lo habrán ignorado, y no se habrán parado a pensar lo que esto implica. Pero tu no, tu reflexionas sobre ello. Primero, buscas la causa del mensaje: esta persona se acaba de levantar de la cama, o eso nos quiere hacer creer. Segundo, reflexionas sobre en que localización se encuentra tu compañero, y qué uso horario suele utilizar. Y concluyes que no debe de estar en un radio mayor a 50 km de tu posición actual. Además en este punto te das cuenta de que no todos los integrantes del chat podrían estar dentro de ese radio de 50 km, incluso podrían estar en otro uso horario muy diferente. Por lo que decir "Buenos días" en tales condiciones carece de sentido. Tercero y último, intentas descifrar que pretende transmitir con ese comunicado: podría significar un mero "Buenos días" en su sentido más estricto, resumiendo, que nos anima a que pasemos un buen día (esto es lo que, probablemente, les pase por la cabeza al resto de usuarios que lo leyesen). Pero eso no es suficiente para ti, tu piensas --No puede ser tan simple--, a lo mejor la intención del emisor es nula, una simple excusa para iniciar una conversación anodina, pero en su subconsciente podríamos hallar un significado oculto, un segundo motivo, o más de uno. Ese segundo motivo podría ser algo como --Me acabo de levantar de la cama a las 5:00 PM, voy a escribir "Buenos días" en el chat para que todo el mundo se de cuenta de que soy más chulo que un ocho por levantarme tarde. A ver si así me preguntan lo que estuve haciendo hasta tan tarde ayer noche--. Esta reflexión del subconsciente es factible debido a que si recalcamos la segunda observación, en caso de que no todos los integrantes del chat se encuentren en el mismo uso horario que el emisor no tendría sentido poner un "Buenos días" sin mencionar que, por ejemplo, esos usuarios desfasados en el plano horario puedan estar en plena noche.
</p>

<p>
    Esta clase de reflexiones no son muy comunes pero cuando surgen así, de la nada, como una inspiración divina, pueden servirte para darte cuenta de cosas ocultas que no tienen ni porque ser verdaderas pero que, personalmente, a mi me fascinan, debido a que no suelen estar mal fundamentadas y son claramente factibles.
</p>

<p>
    "Buenos días" en mi opinión no es un mensaje con sentido que se deba escribir en un grupo de chat. Sobretodo habiendo personas que no comparten tu mismo huso horario. Simplemente, no tiene sentido. Eso es algo que dices por la calle cuando te cruzas con alguien en un pueblo, porque en las ciudades, hoy en día tampoco se practica.
</p>

<p>
    Escrito originalmente el 25 de Enero de 2015 a las 6:12 PM.
</p>
]]>
    </description>
</item>

<item>
    <title>Configurar Ubiquiti EdgeRouter para Movistar TV</title>
    <guid>https://record.rat.la/index.php?page=ubiquiti-er-movistartv.html</guid>
    <link>https://record.rat.la/index.php?page=ubiquiti-er-movistartv.html</link>
    <!--<author>Inoro</author>-->
    <pubDate>Sun, 20 Sep 2020 01:44:00 +0200</pubDate>
    <description>
<![CDATA[<!-- 202009200144i -->
<h1>Configurar Ubiquiti EdgeRouter para Movistar TV</h1>

<p>
    Voy a explicar como conseguí, finalmente, hacer que la televisión de Movistar Plus se vea a través de un EdgeRouter de Ubiquiti, ajustando el escenario de ejemplo a mis necesidades en casa.
</p>

<p>Vamos a suponer que la LAN del HGU es la <strong>192.168.1.0/24</strong> y que la del ER es <strong>192.168.10.0/24</strong>. Esta configuración debería servir para cualquier router EdgeMAX, concretamente este ejemplo se basa en un <strong>ER-X</strong> con la WAN en <strong>eth0</strong> y el resto de puertos configurados como un switch en <strong>switch0</strong>, como se hace en la configuración básica del Wizard.</p>

<blockquote>
    <p>HGU = Router de Movistar, ER = EdgeRouter.</p>
</blockquote>

<h2>Si pruebas esta configuración y tienes fallos, agrega un nuevo issue a <a href="https://github.com/1noro/ubiquiti-er-movistartv">mi repositorio</a>, o <a href="mailto:ppuubblliicc@protonmail.com">contáctame</a>.</h2>

<h2>Escenario</h2>

<p><img src="https://record.rat.la/img/202009200144/mapa.webp" alt="Diagrama del escenario"></p>

<h2>1 - Asignar a la interfaz WAN física del ER una IP fija o por DHCP dentro de la red del HGU</h2>

<p><img src="https://record.rat.la/img/202009200144/1-1.webp" alt="imagen 1-1" class="half"></p>

<h2>2 - Enmascarar todo el tráfico hacia la red del HGU con dicha interfaz</h2>

<p><img src="https://record.rat.la/img/202009200144/2-1.webp" alt="imagen 2-1"></p>

<h2>3 - Añadir un par de rutas al ER para las peticiones IGMP/Multicast</h2>

<p>Rutas estáticas de <strong>tipo Gateway</strong>.</p>

<p><img src="https://record.rat.la/img/202009200144/3-1.webp" alt="imagen 3-1"></p>

<p>No estoy seguro de que sean necesarias todas, pero son las que había en la tabla del router HGU, como se puede ver a continuación:</p>

<p><img src="https://record.rat.la/img/202009200144/3-2.webp" alt="imagen 3-2"></p>

<h2>4 - Configurar el Firewall del ER</h2>

<p>Me baso en las dos Rulesets definidas por la configuración básica del ER a través del Wizard, WAN_IN y WAN_LOCAL.</p>

<p><img src="https://record.rat.la/img/202009200144/4-1.webp" alt="imagen 4-1"></p>

<h2>Reglas de WAN_IN:</h2>

<p>Es importante que se <strong>mantengan en el orden</strong> definido.</p>

<p><img src="https://record.rat.la/img/202009200144/4-2.webp" alt="imagen 4-2"></p>

<p><img src="https://record.rat.la/img/202009200144/4-3.webp" alt="imagen 4-3" class="half"></p>

<p><img src="https://record.rat.la/img/202009200144/4-4.webp" alt="imagen 4-4" class="half"></p>

<h2>Reglas de WAN_LOCAL:</h2>

<p><strong>Las mismas</strong> que las de WAN_IN, pero sospecho que no deberían de hacer falta.</p>

<blockquote>
    <p>Necesita mas pruebas.</p>
</blockquote>

<h2>5 - <a href="https://help.ui.com/hc/en-us/articles/204961854-EdgeRouter-IGMP-Proxy">Habilitar IGMP Proxy en el ER</a></h2>

<p>Nos conectamos a la <strong>terminal</strong> del ER (por la CLI Web o por SSH).</p>

<pre>
configure
</pre>

<pre>
set protocols igmp-proxy interface eth0 role upstream
set protocols igmp-proxy interface switch0 role downstream
</pre>

<pre>
set protocols igmp-proxy interface eth0 threshold 1
set protocols igmp-proxy interface eth0 alt-subnet 0.0.0.0/0

set protocols igmp-proxy interface switch0 threshold 1
set protocols igmp-proxy interface switch0 alt-subnet 0.0.0.0/0
</pre>

<pre>
commit ; save
exit
</pre>

<h2>Comandos para verificar que el tráfico multicast está fluyendo:</h2>

<pre>
show ip multicast mfc
show ip multicast interfaces
</pre>

<h2>6 - Configuración estática de red en el aparato de Movistar TV</h2>

<ul>
    <li>Pulsamos el botón superior con forma de persona en el mando de la TV de Movistar repetidas veces durante el arranque, hasta entrar en el <strong>menú de configuración de red</strong>.</li>
</ul>

<p><img src="https://record.rat.la/img/202009200144/6-1.webp" alt="imagen 6-1" class="half"></p>

<ul>
    <li>Editamos la configuración en modo estático:
        <ul>
            <li>Modo de red: <strong>estático</strong></li>
            <li>Dirección IP: <strong>192.168.10.40</strong></li>
            <li>Máscara de Subred: <strong>255.255.255.0</strong></li>
            <li>Pasarela (Gateway): <strong>192.168.10.1</strong></li>
            <li>Dirección IP del OPCH: <strong>239.0.2.29:22222</strong></li>
            <li>DNS Primario: <strong>172.26.23.3</strong></li>
        </ul>
    </li>
</ul>

<h2>Enlaces en los que me he basado</h2>

<ul>
    <li><a href="https://help.ui.com/hc/en-us/articles/204961854-EdgeRouter-IGMP-Proxy">https://help.ui.com/hc/en-us/articles/204961854-EdgeRouter-IGMP-Proxy</a></li>
    <li><a href="https://comunidad.movistar.es/t5/Soporte-Fibra-y-ADSL/Routers-ubiquiti-con-HGU-mitrastar/m-p/3441509#M313299">https://comunidad.movistar.es/t5/Soporte-Fibra-y-ADSL/Routers-ubiquiti-con-HGU-mitrastar/m-p/3441509#M313299</a></li>
    <li><a href="https://comunidad.movistar.es/t5/Soporte-Fibra-y-ADSL/configuracion-del-router-ax-11000-asus-por-conexion-pppoe-ONT/m-p/4217145#M427122">https://comunidad.movistar.es/t5/Soporte-Fibra-y-ADSL/configuracion-del-router-ax-11000-asus-por-conexion-pppoe-ONT/m-p/4217145#M427122</a></li>
</ul>

<h2>Si pruebas esta configuración y tienes fallos, agrega un nuevo issue a <a href="https://github.com/1noro/ubiquiti-er-movistartv">mi repositorio</a>, o <a href="mailto:ppuubblliicc@protonmail.com">contáctame</a>.</h2>
]]>
    </description>
</item>

<item>
    <title>Sobre las Cookies</title>
    <guid>https://record.rat.la/index.php?page=cookie.html</guid>
    <link>https://record.rat.la/index.php?page=cookie.html</link>
    <!--<author>Inoro</author>-->
    <pubDate>Sat, 19 Sep 2020 22:56:00 +0200</pubDate>
    <description>
<![CDATA[<!-- 202009192256i -->
<h1>Sobre las Cookies</h1>

<p>
    Voy a definir lo que yo creo que es una <i>cookie</i> sin mirar la Wikipedia.
</p>

<p>
    <a title="Ir a la web de origen de la imagen." href="https://uxdesign.cc/did-you-know-that-the-free-cookie-clicker-can-explain-key-mechanics-for-freemium-services-bf5140a50c04">
        <img src="https://record.rat.la/img/cookie.webp" alt="Imagen de cabecera, abuela con una cookie.">
    </a>
</p>

<blockquote>
    Una <i>cookie</i>, <b>galleta</b> en castellano, es un valor; un pequeño texto o un número que la página web guarda en tu PC para que la próxima vez que vuelvas a acceder a ella, esta pueda leer esa información. Normalmente haciendo que no tengas que volver a introducir datos, o guardando configuraciones que se cargarán automáticamente.
</blockquote>

<p>
    Y dirías tú ¿Y para que le sirve a una web hacer eso? Pues te lo voy a explicar con una parábola.
</p>

<p>
    &laquo;Esta era una reina muy feliz a la que le encantaba saludar por su nombre a cada persona que se cruzaba por la calle cuando salía de palacio. Pero tenía un problema, ella era incapaz de saber saber los nombres de todos sus plebeyos, pues eran muchos. Y cada día unos se morían y otros nuevos nacían.
</p>

<p>
    Pero un día, mientras dormía tubo una revelación. La próxima vez que viese a alguien por la calle, le preguntaría su nombre, lo escribiría en un papel y se lo pegaría en la frente. Como ella era la reina, a nadie le iba a molestar. Así la próxima vez que ese pobre ciudadano se cruzase con ella, con solo mirarle a la cara, leería el papel que tiene en la frente, y podría saludarlo por su nombre sin tener que volver a preguntárselo.&raquo;
</p>

<p>
    ¿Que tal? ¿Bonita, verdad? Pues eso es lo que hago yo con mi web. La única <i>cookie</i> que guardo en tu ordenador es un número que me indica que paleta de colores quieres usar para leer mis artículos. El 0 me dice que quieres la paleta por defecto, el 1 que eres un darks (o un receloso de tu batería) y te gusta leer todo en negro, el 3 que eres un soso y solo quieres los colores como manda el navegador, etc.
</p>

<p>
    Y por mi parte, si eres de esos paranoicos de la privacidad (como yo), que piensan que las <i>cookies</i> son el demonio, y haces que tu navegador las borre cada 30 segundos, por mi perfecto, no hay ningún problema. Pero solo vas a poder leer la página con los colores por defecto.
</p>

<p>
    Y ahora veamos cómo define la Wikipedia una <i>cookie</i>.
</p>

<blockquote cite="https://es.wikipedia.org/wiki/Cookie_(inform%C3%A1tica)">
    El anglicismo <i>cookie</i>, usado también <b>galleta</b> o <b>galleta informática</b> , es un término que hace referencia a una pequeña información enviada por un sitio web y almacenada en el navegador del usuario, de manera que el sitio web puede consultar la actividad previa del navegador. <a href="https://es.wikipedia.org/wiki/Cookie_(inform%C3%A1tica)">Leer mas...</a>
</blockquote>

<p>
    Bueno, pues mas o menos lo que yo dije.
</p>

<!--
<h2>¿Porqué tienen mala fama?</h2>

leer https://www.bbc.com/mundo/noticias-40443519

-->
]]>
    </description>
</item>

<item>
    <title>Un servidor para record.rat.la</title>
    <guid>https://record.rat.la/index.php?page=configurando-nginx-para-esta-web.html</guid>
    <link>https://record.rat.la/index.php?page=configurando-nginx-para-esta-web.html</link>
    <!--<author>Inoro</author>-->
    <pubDate>Sat, 19 Sep 2020 01:40:00 +0200</pubDate>
    <description>
<![CDATA[<!-- 202009190140i -->
<h1>Un servidor para record.rat.la</h1>

<blockquote>
    <!-- Lo pongo en un blockquote para que la descripción del artículo siga siendo la misma -->
    <b>(ARTÍCULO DESACTUALIZADO)</b>
</blockquote>

<p>
    Como por el momento esta web será para uso personal, y no tendrá una enorme carga de trabajo, voy a optar por instalarla en una máquina virtual <a href="https://www.debian.org/index.es.html">Debian</a> 10 en mi servidor <a href="https://www.proxmox.com/en/">Proxmox</a>.
</p>

<p>
    Aprovechando que siempre quise tener una web bajo un servidor <a href="https://www.nginx.com/">Nginx</a> en ved de <a href="https://httpd.apache.org/">Apache2</a>, voy a utilizar esta oportunidad para aprender.
</p>

<p>
    Como primer paso voy a descargar mi web en el directorio <samp>/var/wwww</samp>.
</p>

<pre>
cd /var/wwww
git clone https://github.com/1noro/record.rat.la.git
chmod 777 -R record.rat.la.git
</pre>

<h2>Configurando Nginx en Debian 10</h2>

<pre>
apt install git nginx php-fpm
</pre>

<p>
    En el archivo <samp>/etc/php/7.3/fpm/php.ini</samp> cambiamos <code>;cgi.fix_pathinfo=1</code> por <code>cgi.fix_pathinfo=0</code>.
</p>

<pre>
systemctl restart php7.3-fpm.service
</pre>

<p>
    Hacemos una copia de seguridad del archivo <samp>/etc/nginx/sites-available/default</samp> antes de modificarlo.
</p>

<p>
    Tomando como referencia <samp>/etc/nginx/sites-available/default</samp> creamos <samp>/etc/nginx/conf.d/record.rat.la.conf</samp>.
</p>

<pre>
cp /etc/nginx/sites-available/default /etc/nginx/conf.d/record.rat.la.conf
</pre>

<p>
    Luego comentamos todas las lineas de <samp>/etc/nginx/sites-available/default</samp> para que quede "vacío".
</p>

<p>
    Ahora editamos <samp>/etc/nginx/conf.d/record.rat.la.conf</samp>.
</p>

<h3><samp>record.rat.la.conf</samp> original</h3>

<pre>
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    # SSL configuration
    #
    # listen 443 ssl default_server;
    # listen [::]:443 ssl default_server;
    #
    # Note: You should disable gzip for SSL traffic.
    # See: https://bugs.debian.org/773332
    #
    # Read up on ssl_ciphers to ensure a secure configuration.
    # See: https://bugs.debian.org/765782
    #
    # Self signed certs generated by the ssl-cert package
    # Don't use them in a production server!
    #
    # include snippets/snakeoil.conf;

    root /var/www/html;

    # Add index.php to the list if you are using PHP
    index index.html index.htm index.nginx-debian.html;

    server_name _;

    location / {
        # First attempt to serve request as file, then
        # as directory, then fall back to displaying a 404.
        try_files $uri $uri/ =404;
    }

    # pass PHP scripts to FastCGI server
    #
    #location ~ \.php$ {
    #    include snippets/fastcgi-php.conf;
    #
    #    # With php-fpm (or other unix sockets):
    #    fastcgi_pass unix:/run/php/php7.3-fpm.sock;
    #    # With php-cgi (or other tcp sockets):
    #    fastcgi_pass 127.0.0.1:9000;
    #}

    # deny access to .htaccess files, if Apache's document root
    # concurs with nginx's one
    #
    #location ~ /\.ht {
    #    deny all;
    #}
}


# Virtual Host configuration for example.com
#
# You can move that to a different file under sites-available/ and symlink that
# to sites-enabled/ to enable it.
#
#server {
#   listen 80;
#   listen [::]:80;
#
#   server_name example.com;
#
#   root /var/www/example.com;
#   index index.html;
#
#   location / {
#       try_files $uri $uri/ =404;
#   }
#}
</pre>

<h3>Modificaciones</h3>

<ul>
    <li>En primer lugar, necesitamos agregar <samp>index.php</samp> como el primer valor de nuestra directiva de índice para que los archivos denominados <samp>index.php</samp> se sirvan, si están disponibles, cuando se solicita un directorio.</li>
    <li>Podemos modificar la directiva <code>server_name</code> para apuntar al nombre de dominio de nuestro servidor o a la dirección IP pública.</li>
    <li>Para el procesamiento real de PHP, solo necesitamos descomentar un segmento del archivo que maneja las solicitudes de PHP. Éste será el bloque de ubicación <code>~.php$</code>, el fragmento <samp>fastcgi-php.conf</samp> incluido y el socket asociado con <code>php-fpm</code>.</li>
    <li>También hay que remover los comentarios del bloque de ubicación que trata con archivos <samp>.htaccess</samp>. Nginx no procesa estos archivos. Si alguno de estos archivos encuentra la forma de llegar a un documento root, no deben ser servidos a los visitantes.</li>
</ul>

<h3><samp>record.rat.la.conf</samp> modificado</h3>

<pre>
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    # SSL configuration
    #
    # listen 443 ssl default_server;
    # listen [::]:443 ssl default_server;
    #
    # Note: You should disable gzip for SSL traffic.
    # See: https://bugs.debian.org/773332
    #
    # Read up on ssl_ciphers to ensure a secure configuration.
    # See: https://bugs.debian.org/765782
    #
    # Self signed certs generated by the ssl-cert package
    # Don't use them in a production server!
    #
    # include snippets/snakeoil.conf;

    root /var/www/record.rat.la;

    # Add index.php to the list if you are using PHP
    index index.php index.html index.htm index.nginx-debian.html;

    server_name record.rat.la;

    location / {
        # First attempt to serve request as file, then
        # as directory, then fall back to displaying a 404.
        try_files $uri $uri/ =404;
    }

    # pass PHP scripts to FastCGI server
    #
    location ~ \.php$ {
        include snippets/fastcgi-php.conf;

        # With php-fpm (or other unix sockets):
        fastcgi_pass unix:/run/php/php7.3-fpm.sock;
        # With php-cgi (or other tcp sockets):
        #fastcgi_pass 127.0.0.1:9000;
    }

    # deny access to .htaccess files, if Apache's document root
    # concurs with nginx's one
    #
    location ~ /\.ht {
        deny all;
    }
}


# Virtual Host configuration for example.com
#
# You can move that to a different file under sites-available/ and symlink that
# to sites-enabled/ to enable it.
#
#server {
#   listen 80;
#   listen [::]:80;
#
#   server_name example.com;
#
#   root /var/www/example.com;
#   index index.html;
#
#   location / {
#        try_files $uri $uri/ =404;
#   }
#}
</pre>

<p>Probamos la configuración y recargamos nginx.</p>

<pre>
nginx -t
systemctl reload nginx
</pre>

<h2>SSL con Lets Encrypt y Nginx en Debian 10</h2>

<p>Instalaciones iniciales:</p>

<pre>
apt install python3-acme python3-certbot python3-mock python3-openssl python3-pkg-resources python3-pyparsing python3-zope.interface
apt install python3-certbot-nginx
</pre>

<p>Con el <i>Virtual Host</i> correctamente configurado en Nginx (como se indica en el apartado anterior), ejecutamos el <samp>certbot</samp></p>

<pre>
certbot --nginx -d record.rat.la
</pre>

<p>Respondemos a todas las preguntas a nuestro gusto y al final aparece esto:</p>

<pre>
IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at:
   /etc/letsencrypt/live/record.rat.la/fullchain.pem
   Your key file has been saved at:
   /etc/letsencrypt/live/record.rat.la/privkey.pem
   Your cert will expire on 2020-12-18. To obtain a new or tweaked
   version of this certificate in the future, simply run certbot again
   with the "certonly" option. To non-interactively renew *all* of
   your certificates, run "certbot renew"
 - Your account credentials have been saved in your Certbot
   configuration directory at /etc/letsencrypt. You should make a
   secure backup of this folder now. This configuration directory will
   also contain certificates and private keys obtained by Certbot so
   making regular backups of this folder is ideal.
 - If you like Certbot, please consider supporting our work by:

   Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
   Donating to EFF:                    https://eff.org/donate-le
</pre>

<p>Si volvemos a <samp>record.rat.la.conf</samp> veremos que <samp>certbot</samp> ha agregado unas lineas a nuestra configuración.</p>

<pre>
listen [::]:443 ssl ipv6only=on; # managed by Certbot
listen 443 ssl; # managed by Certbot
ssl_certificate /etc/letsencrypt/live/record.rat.la/fullchain.pem; # managed by Certbot
ssl_certificate_key /etc/letsencrypt/live/record.rat.la/privkey.pem; # managed by Certbot
include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
</pre>

<h3>SSL Certbot Auto-Renewal</h3>

<p>Nos aseguramos de que cron se está ejecutando.</p>

<pre>
systemctl enable cron
systemctl start cron
</pre>

<p>Una vez instalado <samp>certbot</samp> se agrega automáticamente a <samp>cron</samp> para ejecutarse dos veces al día. De todas formas podemos probar que esto funciona correctamente ejecutando un simulacro de renovación.</p>

<pre>
certbot renew --dry-run
</pre>

<h2>Script para actualizar la web desde mi PC personal</h2>

<p>Para facilitar la actualización de la web, este script puede ser muy útil.</p>

<pre>
ssh user@server_ip_or_domain 'git -C /var/www/record.rat.la pull'
</pre>

<h2>Habilitar el header HTTP, <em>charset</em> UTF-8</h2>

<p>
    Editamos el archivo <samp>/etc/nginx/nginx.conf</samp> y agregamos la siguiente línea a la configuración del bloque <samp>http</samp>.
</p>

<pre>
charset UTF-8;
</pre>

<p>
    Guarda el archivo y recarga/reinicia el servicio.
</p>

<pre>
nginx -t
systemctl reload nginx
</pre>

<h2>Bibliografía</h2>

<ul>
    <li><a href="https://www.digitalocean.com/community/tutorials/como-instalar-linux-nginx-mysql-php-lemp-stack-in-ubuntu-16-04-es">¿Cómo Instalar Linux, Nginx, MySQL, PHP (LEMP stack) in Ubuntu 16.04?</a></li>
    <li><a href="https://www.nginx.com/blog/using-free-ssltls-certificates-from-lets-encrypt-with-nginx/">Update: Using Free Let’s Encrypt SSL/TLS Certificates with NGINX</a></li>
    <li><a href="https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-debian-10">How To Secure Nginx with Let's Encrypt on Debian 10</a></li>
    <li><a href="https://stackoverflow.com/questions/7622616/executing-a-git-pull-from-a-different-directory">Executing a git pull from a different directory</a></li>
    <li><a href="https://malcontentcomics.com/systemsboy/2006/07/send-remote-commands-via-ssh.html">Send Remote Commands Via SSH</a></li>
    <li><a href="https://www.howtoforge.com/make-browsers-cache-static-files-on-nginx">Make Browsers Cache Static Files On nginx</a></li>
    <li><a href="https://www.cyberciti.biz/faq/nginx-set-http-content-type-response-header-to-charset-utf8/">How do I enable charset HTTP-header in Nginx?</a></li>
</ul>
]]>
    </description>
</item>

    </channel>
</rss>